An error occurred while executing the following cell:
------------------

import numpy as np
import matplotlib.pyplot as plt
try:
    from cycler import cycler
except:
    %pip install cycler
    from cycler import cycler
from scipy.spatial.distance import cdist
import probml_utils as pml

np.random.seed(0)
CB_color = ['#377eb8', '#ff7f00']

cb_cycler = (cycler(linestyle=['-', '--', '-.']) * cycler(color=CB_color))
plt.rc('axes', prop_cycle=cb_cycler)


def fun(x, w):
    return w[0] * x + w[1] * np.square(x)


# 'Data as mentioned in the matlab code'
def polydatemake():
    n = 21
    sigma = 2
    xtrain = np.linspace(0, 20, n)
    xtest = np.arange(0, 20.1, 0.1)
    w = np.array([-1.5, 1 / 9])
    ytrain = fun(xtrain, w).reshape(-1, 1) + np.random.randn(xtrain.shape[0], 1)
    ytestNoisefree = fun(xtest, w)
    ytestNoisy = ytestNoisefree + sigma * np.random.randn(xtest.shape[0], 1) * sigma

    return xtrain, ytrain, xtest, ytestNoisefree, ytestNoisy


[xtrain, ytrain, xtest, ytestNoisefree, ytestNoisy] = polydatemake()

sigmas = [0.5, 10, 50]
K = 10
centers = np.linspace(np.min(xtrain), np.max(xtrain), K)


def addones(x):
    # x is of shape (s,)
    return np.insert(x[:, np.newaxis], 0, [[1]], axis=1)


def rbf_features(X, centers, sigma):
    dist_mat = cdist(X, centers, 'minkowski', p=2.)
    return np.exp((-0.5 / (sigma ** 2)) * (dist_mat ** 2))


# using matrix inversion for ridge regression
def ridgeReg(X, y, lambd):  # returns weight vectors.
    D = X.shape[1]
    w = np.linalg.inv(X.T @ X + lambd * np.eye(D, D)) @ X.T @ y

    return w


fig, ax = plt.subplots(3, 3, figsize=(10,10))
plt.tight_layout()

for (i, s) in enumerate(sigmas):
    rbf_train = rbf_features(addones(xtrain), addones(centers), s)
    rbf_test = rbf_features(addones(xtest), addones(centers), s)
    reg_w = ridgeReg(rbf_train, ytrain, 0.3)
    ypred = rbf_test @ reg_w

    ax[i, 0].plot(xtrain, ytrain, '.', markersize=8)
    ax[i, 0].plot(xtest, ypred)
    ax[i, 0].set_ylim([-10, 20])
    ax[i, 0].set_xticks(np.arange(0, 21, 5))

    for j in range(K):
        ax[i, 1].plot(xtest, rbf_test[:, j], 'b-')
        ax[i, 1].set_xticks(np.arange(0, 21, 5))
        ax[i, 1].ticklabel_format(style='sci', scilimits=(-2, 2))

    ax[i, 2].imshow(rbf_train, interpolation='nearest', aspect='auto', cmap=plt.get_cmap('viridis'))
    ax[i, 2].set_yticks(np.arange(20, 4, -5))
    ax[i, 2].set_xticks(np.arange(2, 10, 2))
pml.savefig("figures/rbfDemoALL.pdf", dpi=300)
plt.show()

------------------

---------------------------------------------------------------------------
FileNotFoundError                         Traceback (most recent call last)
Input In [1], in <cell line: 83>()
     81     ax[i, 2].set_yticks(np.arange(20, 4, -5))
     82     ax[i, 2].set_xticks(np.arange(2, 10, 2))
---> 83 pml.savefig("figures/rbfDemoALL.pdf", dpi=300)
     84 plt.show()

File /usr/local/lib/python3.9/dist-packages/probml_utils/plotting.py:75, in savefig(f_name, fig_dir, tight_layout, tight_bbox, *args, **kwargs)
     73     plt.savefig(fname_full, pad_inches=0.0, bbox_inches="tight", *args, **kwargs)
     74 else:
---> 75     plt.savefig(fname_full, pad_inches=0.0, *args, **kwargs)

File /usr/local/lib/python3.9/dist-packages/matplotlib/pyplot.py:958, in savefig(*args, **kwargs)
    955 @_copy_docstring_and_deprecators(Figure.savefig)
    956 def savefig(*args, **kwargs):
    957     fig = gcf()
--> 958     res = fig.savefig(*args, **kwargs)
    959     fig.canvas.draw_idle()   # need this if 'transparent=True' to reset colors
    960     return res

File /usr/local/lib/python3.9/dist-packages/matplotlib/figure.py:3019, in Figure.savefig(self, fname, transparent, **kwargs)
   3015     for ax in self.axes:
   3016         stack.enter_context(
   3017             ax.patch._cm_set(facecolor='none', edgecolor='none'))
-> 3019 self.canvas.print_figure(fname, **kwargs)

File /usr/local/lib/python3.9/dist-packages/matplotlib/backend_bases.py:2319, in FigureCanvasBase.print_figure(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, pad_inches, bbox_extra_artists, backend, **kwargs)
   2315 try:
   2316     # _get_renderer may change the figure dpi (as vector formats
   2317     # force the figure dpi to 72), so we need to set it again here.
   2318     with cbook._setattr_cm(self.figure, dpi=dpi):
-> 2319         result = print_method(
   2320             filename,
   2321             facecolor=facecolor,
   2322             edgecolor=edgecolor,
   2323             orientation=orientation,
   2324             bbox_inches_restore=_bbox_inches_restore,
   2325             **kwargs)
   2326 finally:
   2327     if bbox_inches and restore_bbox:

File /usr/local/lib/python3.9/dist-packages/matplotlib/backend_bases.py:1648, in _check_savefig_extra_args.<locals>.wrapper(*args, **kwargs)
   1640     _api.warn_deprecated(
   1641         '3.3', name=name, removal='3.6',
   1642         message='%(name)s() got unexpected keyword argument "'
   1643                 + arg + '" which is no longer supported as of '
   1644                 '%(since)s and will become an error '
   1645                 '%(removal)s')
   1646     kwargs.pop(arg)
-> 1648 return func(*args, **kwargs)

File /usr/local/lib/python3.9/dist-packages/matplotlib/_api/deprecation.py:386, in delete_parameter.<locals>.wrapper(*inner_args, **inner_kwargs)
    381 @functools.wraps(func)
    382 def wrapper(*inner_args, **inner_kwargs):
    383     if len(inner_args) <= name_idx and name not in inner_kwargs:
    384         # Early return in the simple, non-deprecated case (much faster than
    385         # calling bind()).
--> 386         return func(*inner_args, **inner_kwargs)
    387     arguments = signature.bind(*inner_args, **inner_kwargs).arguments
    388     if is_varargs and arguments.get(name):

File /usr/local/lib/python3.9/dist-packages/matplotlib/backends/backend_pdf.py:2778, in FigureCanvasPdf.print_pdf(self, filename, dpi, bbox_inches_restore, metadata)
   2776     file = filename._file
   2777 else:
-> 2778     file = PdfFile(filename, metadata=metadata)
   2779 try:
   2780     file.newPage(width, height)

File /usr/local/lib/python3.9/dist-packages/matplotlib/backends/backend_pdf.py:654, in PdfFile.__init__(self, filename, metadata)
    652 self.original_file_like = None
    653 self.tell_base = 0
--> 654 fh, opened = cbook.to_filehandle(filename, "wb", return_opened=True)
    655 if not opened:
    656     try:

File /usr/local/lib/python3.9/dist-packages/matplotlib/cbook/__init__.py:451, in to_filehandle(fname, flag, return_opened, encoding)
    449         fh = bz2.BZ2File(fname, flag)
    450     else:
--> 451         fh = open(fname, flag, encoding=encoding)
    452     opened = True
    453 elif hasattr(fname, 'seek'):

FileNotFoundError: [Errno 2] No such file or directory: 'figures/figures/rbfDemoALL.pdf'
FileNotFoundError: [Errno 2] No such file or directory: 'figures/figures/rbfDemoALL.pdf'
